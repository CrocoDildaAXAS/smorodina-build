import{j as m,O as C,k as c,o as h,x as r,q as i,s as t,F as l,G as g,K as $,B as p,v as w,y as _,E as y,C as S}from"./DAn7dnkX.js";import{a as d,c as x,b}from"./BTbU19mV.js";import{u as j}from"./BhQnxzue.js";import{p as B}from"./CYuQ_TKu.js";const D={};function L(s,o){return null}const I=m(D,[["render",L]]),f=C("category",{state:()=>({id:""})}),P={data(){return{products:[],token:""}},mounted(){this.token=d.get("authtoken"),this.fetchData()},computed:{...c(x,["url"]),...c(f,["id"])},watch:{id:"fetchData"},methods:{...h(j,["setCurrentLayout"]),...h(B,["setProdId"]),async fetchData(){try{const s=await b.get(`${this.url}api/cp/products/${this.id?`?categoryId=${this.id}`:""}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`}});s.data.message==="Error"?this.$router.push("/auth/login"):this.products=s.data}catch(s){console.error("ОШИБКА:",s),this.$router.push("/auth/login"),d.remove("authtoken")}},changeLayout(s){this.setProdId(s),this.setCurrentLayout("editproduct"),console.log("Текущий макет:","editproduct","ID продукта:",s)}}},A={class:""},V={class:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 sm:gap-6"},E=["href","onClick"],M={class:"p-4 md:p-5"},z={class:"flex justify-between items-center gap-x-3"},N={class:"grow"},F={class:"flex items-center gap-x-3"},O={class:"w-[38px] h-[38px] rounded-full bg-gray-200 flex items-center justify-center overflow-hidden"},T=["src"],U={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6 text-gray-400"},q=t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"},null,-1),G=[q],K={class:"grow"},H={class:"group-hover:text-gray-200 font-semibold text-white"},J=t("div",null,[t("svg",{class:"shrink-0 size-5 text-white",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"m9 18 6-6-6-6"})])],-1),Q={class:"w-full h-full"};function R(s,o,v,k,n,a){const u=I;return r(),i(l,null,[t("div",A,[t("div",V,[(r(!0),i(l,null,g(n.products,e=>(r(),i("a",{key:e.id,href:`/admin/product/${e.id}`,onClick:$(ae=>a.changeLayout(e.id),["prevent"]),class:"group flex flex-col bg-red-300 shadow-sm rounded-xl hover:shadow-md focus:outline-none focus:shadow-md transition"},[t("div",M,[t("div",z,[t("div",N,[t("div",F,[t("div",O,[e.images&&e.images.length>0?(r(),i("img",{key:0,class:"w-full h-full object-cover",src:e.images.slice(-1)[0].image,alt:"Product image"},null,8,T)):(r(),i("svg",U,G))]),t("div",K,[t("h3",H,p(e.name),1)])])]),J])])],8,E))),128))])]),t("div",Q,[w(u)])],64)}const W=m(P,[["render",R]]),X={data(){return{token:"",categories:[],subCategories:[],selectedCategory:"",selectedSubCategory:null}},computed:{...c(x,["url"]),...c(f,["id"])},mounted(){this.token=d.get("authtoken"),this.getCategories(),this.$patch({id:""})},methods:{...h(f,["$patch"]),async getCategories(){try{const s=await b.get(`${this.url}api/cp/categories/`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`}});s.data.message==="Error"?this.$router.push("/auth/login"):this.categories=s.data}catch(s){console.error("ОШИБКА:",s),this.$router.push("/auth/login"),d.remove("authtoken")}},fetchSubCategories(){if(this.selectedCategory===""){this.subCategories=[],this.selectedSubCategory=null,this.$patch({id:null});return}const s=this.categories.find(o=>o.id===this.selectedCategory);s&&Array.isArray(s.subcategories)?(this.subCategories=s.subcategories,this.selectedSubCategory=null,this.$patch({id:this.selectedCategory})):(this.subCategories=[],this.selectedSubCategory=null,this.$patch({id:""}))},updateSubCategory(){this.$patch({id:this.selectedSubCategory})}}},Y={class:"flex flex-col md:flex-row justify-center items-start pb-10 md:space-x-4 space-y-4 md:space-y-0"},Z={class:"w-full md:w-full"},ee=t("option",{value:"",class:"py-2 px-4 text-sm text-black cursor-pointer font-montserrat hover:bg-white rounded-lg focus:outline-none focus:bg-white"}," Все категории ",-1),te=["value"],se={key:0,class:"w-full md:w-1/5"},oe=t("option",{value:null,class:"text-black"}," Выберите подкатегорию ",-1),re=["value"],ie={class:"w-full h-full"};function ne(s,o,v,k,n,a){const u=W;return r(),i(l,null,[t("div",Y,[t("div",Z,[_(t("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>n.selectedCategory=e),onChange:o[1]||(o[1]=(...e)=>a.fetchSubCategories&&a.fetchSubCategories(...e)),class:"relative py-3 ps-4 pe-9 block w-full cursor-pointer bg-white border font-montserrat border-pink-700 rounded-lg text-sm text-black focus:outline-none focus:ring-pink-600",style:{overflow:"hidden","overflow-y":"auto","max-height":"72px"}},[ee,(r(!0),i(l,null,g(n.categories,e=>(r(),i("option",{key:e.id,value:e.id,class:"py-2 px-4 text-sm text-black cursor-pointer font-montserrat hover:bg-white rounded-lg focus:outline-none focus:bg-white"},p(e.name),9,te))),128))],544),[[y,n.selectedCategory]])]),n.selectedCategory&&n.subCategories.length>0?(r(),i("div",se,[_(t("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>n.selectedSubCategory=e),onChange:o[3]||(o[3]=(...e)=>a.updateSubCategory&&a.updateSubCategory(...e)),class:"relative py-3 ps-4 pe-9 block w-full cursor-pointer bg-white border font-montserrat border-pink-700 rounded-lg text-sm text-black focus:outline-none focus:ring-2 focus:ring-pink-600",style:{overflow:"hidden","overflow-y":"auto","max-height":"72px"}},[oe,(r(!0),i(l,null,g(n.subCategories,e=>(r(),i("option",{key:e.id,value:e.id,class:"py-2 px-4 text-sm text-black cursor-pointer font-montserrat hover:bg-white rounded-lg focus:outline-none focus:bg-white"},p(e.name),9,re))),128))],544),[[y,n.selectedSubCategory]])])):S("",!0)]),t("div",ie,[w(u)])],64)}const he=m(X,[["render",ne]]);export{he as default};
